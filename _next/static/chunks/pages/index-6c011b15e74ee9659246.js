(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5283:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthContext:function(){return C},default:function(){return F}});var n=r(5893),s=r(3391),a=r(6156),i=r(7294);function o(e){var t=i.useContext(C).dispatch;function r(){return e.isAuthenticated?(0,n.jsx)("div",{className:"flex",children:(0,n.jsx)("p",{onClick:s,className:"p-4 hover:bg-gray-100 cursor-pointer",children:"Log Out"})}):null}function s(e){e.preventDefault(),t({type:"LOGOUT"})}return(0,n.jsxs)("nav",{className:"h-12 bg-gray-300 flex items-center justify-between px-4",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("p",{className:"mr-2 text-2xl",children:"Filejet"}),(0,n.jsx)("img",{src:"/svg/logo.svg",alt:"logo",className:"w-8 h-8"})]}),(0,n.jsx)(r,{})]})}var l=r(9669),c=r.n(l);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(){var e=i.useContext(C).dispatch,t=i.useState({email:"",password:"",isSubmitting:!1,errorMessage:null}),r=(0,s.Z)(t,2),o=r[0],l=r[1],u=function(e){l(d(d({},o),{},(0,a.Z)({},e.target.name,e.target.value)))};return(0,n.jsx)("div",{className:"w-full h-full p-12",children:(0,n.jsxs)("form",{className:"grid gap-4",onSubmit:function(t){t.preventDefault(),l(d(d({},o),{},{isSubmitting:!0,errorMessage:null})),c().post("http://localhost:5000/api/auth",{email:o.email,password:o.password}).then((function(t){e({type:"LOGIN",payload:t})})).catch((function(e){l(d(d({},o),{},{isSubmitting:!1,errorMessage:e.message||e.statusText}))}))},children:[(0,n.jsx)("p",{children:"Login"}),(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("label",{className:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"login-email",children:"Email"}),(0,n.jsx)("input",{className:"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",id:"login-email",name:"email",type:"email",placeholder:"email@email.com",value:o.email,onChange:u})]}),(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("label",{className:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"login-password",children:"Password"}),(0,n.jsx)("input",{className:"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",id:"login-password",name:"password",type:"password",placeholder:"******************",value:o.password,onChange:u})]}),o.errorMessage&&(0,n.jsx)("span",{className:"form-error",children:"Wrong username or password"}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{disabled:o.isSubmitting,className:"bg-blue-600 hover:bg-blue-700 duration-300 text-white shadow p-2 rounded-r",children:o.isSubmitting?"Loading...":"Log in"})})]})})}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(){var e=i.useContext(C).dispatch,t=i.useState({name:"",email:"",password:"",isSubmitting:!1,errorMessage:null}),r=(0,s.Z)(t,2),o=r[0],l=r[1],u=function(e){l(h(h({},o),{},(0,a.Z)({},e.target.name,e.target.value)))};return(0,n.jsx)("div",{className:"w-full h-full p-12",children:(0,n.jsxs)("form",{className:"grid gap-4",onSubmit:function(t){t.preventDefault(),l(h(h({},o),{},{isSubmitting:!0,errorMessage:null})),c().post("http://localhost:5000/api/users",{name:o.name,email:o.email,password:o.password}).then((function(t){e({type:"LOGIN",payload:t})})).catch((function(e){l(h(h({},o),{},{isSubmitting:!1,errorMessage:e.message||e.statusText}))}))},children:[(0,n.jsx)("p",{children:"Register"}),(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("label",{className:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"register-name",children:"Name"}),(0,n.jsx)("input",{className:"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white",id:"register-name",name:"name",type:"text",placeholder:"Jane",value:o.name,onChange:u})]}),(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("label",{className:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"register-email",children:"Email"}),(0,n.jsx)("input",{className:"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",id:"register-email",name:"email",type:"email",placeholder:"email@email.com",value:o.email,onChange:u})]}),(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("label",{className:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"register-password",children:"Password"}),(0,n.jsx)("input",{className:"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",id:"register-password",name:"password",type:"password",placeholder:"******************",value:o.password,onChange:u})]}),o.errorMessage&&(0,n.jsx)("span",{className:"form-error",children:"Please fill out all fields"}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{disabled:o.isSubmitting,className:"bg-blue-600 hover:bg-blue-700 duration-300 text-white shadow p-2 rounded-r",children:o.isSubmitting?"Loading...":"Sign up"})})]})})}function m(){return(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,n.jsx)(p,{}),(0,n.jsx)(f,{})]})}var b=r(3253),x=r.n(b),j=r(9249),y={content:{width:"26rem",top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};function w(e){var t=e.file,r=e.onFileDelete,a=e.state,o=i.useState(!1),l=(0,s.Z)(o,2),u=l[0],d=l[1];function p(){d(!1)}function g(){var e=Object.assign({},t);return e.file_data="...",(0,n.jsx)("pre",{children:JSON.stringify(e,null,2)})}return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{onClick:function(){d(!0)},className:"flex flex-col justify-center items-center hover:bg-gray-100 p-4 cursor-pointer",children:[(0,n.jsx)("img",{src:"/svg/file.svg",alt:t.name,className:"w-20 h-20"}),(0,n.jsx)("p",{children:t.name})]}),(0,n.jsx)(x(),{isOpen:u,onRequestClose:p,style:y,contentLabel:"Example Modal",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("p",{children:t.name}),(0,n.jsx)("p",{onClick:p,className:"cursor-pointer",children:"X"})]}),(0,n.jsx)("div",{className:"p-2 bg-gray-100 mt-4 overflow-scroll",children:(0,n.jsx)(g,{})}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("button",{onClick:function(){console.log("downloading"),console.log(t._id),console.log(a.user._id),c()({method:"GET",url:"http://localhost:5000/api/files/download",params:{_id:t._id,ownerId:a.user._id}}).then((function(e){return j.Am.success("Success")})).catch((function(e){return j.Am.error("Error")}))},className:"bg-blue-600 hover:bg-blue-700 duration-300 text-white shadow p-2 rounded-r mr-4",children:"Download"}),(0,n.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 duration-300 text-white shadow p-2 rounded-r",onClick:function(){c()({method:"delete",url:"http://localhost:5000/api/files",data:{_id:t._id}}).then((function(e){return j.Am.success("File deleted")}),p(),r()).catch((function(e){return j.Am.error("Error")}))},children:"Delete"})]})]})})]})}x().setAppElement("#app");var v={content:{width:"26rem",top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};function O(e){var t=e.state,r=e.onFileDelete,a=i.useState(!1),o=(0,s.Z)(a,2),l=o[0],c=o[1],u=i.useState(),d=(0,s.Z)(u,2),p=d[0],g=d[1],h=i.useState(!1),f=(0,s.Z)(h,2),m=f[0],b=f[1];function y(){b(!1),g({}),c(!1)}return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{onClick:function(){c(!0)},className:"flex h-full flex-col justify-center items-center hover:bg-gray-100 p-4 cursor-pointer",children:(0,n.jsx)("img",{src:"/svg/plus.svg",alt:"file",className:"w-20 h-20 "})}),(0,n.jsx)(x(),{isOpen:l,onRequestClose:y,style:v,contentLabel:"Example Modal",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("p",{children:"File upload"}),(0,n.jsx)("p",{onClick:y,className:"cursor-pointer",children:"X"})]}),(0,n.jsx)("div",{className:"p-2 bg-gray-100 mt-4",children:m?(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:['"name": ',p.name]}),(0,n.jsxs)("p",{children:['"filetype": ',p.type]}),(0,n.jsxs)("p",{children:['"size": ',p.size]}),(0,n.jsxs)("p",{children:['"date": ',p.lastModifiedDate.toLocaleDateString()]})]}):(0,n.jsx)("p",{children:"Select a file to show details"})}),(0,n.jsxs)("label",{htmlFor:"fileInput",className:"flex flex-col justify-center items-center hover:bg-gray-100 p-4 cursor-pointer mt-4",children:[(0,n.jsx)("p",{children:"Select File"}),(0,n.jsx)("input",{className:"hidden",id:"fileInput",type:"file",name:"file",onChange:function(e){g(e.target.files[0]),b(!0)}})]}),(0,n.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,n.jsx)("button",{type:"button",disabled:!m,onClick:function(){var e=new FormData;e.append("File",p),e.append("ownerId",t.user._id),fetch("http://localhost:5000/api/files",{method:"POST",body:e}).then((function(e){return e.json()})).then((function(e){j.Am.success("File uploaded"),y(),r()})).catch((function(e){j.Am.error("Error")}))},className:"bg-blue-600 hover:bg-blue-700 duration-300 text-white shadow p-2 rounded-r",children:"Upload File"}),(0,n.jsx)("button",{type:"button",onClick:y,className:"bg-blue-600 hover:bg-blue-700 duration-300 text-white shadow p-2 rounded-r",children:"Cancel"})]})]})})]})}x().setAppElement("#app");r(6406);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e){var t=e.state,r=i.useState({files:[]}),a=(0,s.Z)(r,2),o=a[0],l=a[1];function u(){console.log("fetching data"),c()({method:"get",url:"http://localhost:5000/api/files",params:{ownerId:t.user._id}}).then((function(e){l(P(P({},o),{},{files:e.data}))})).catch((function(e){console.log(e)}))}function d(){setTimeout((function(){u()}),1e3)}return i.useEffect((function(){console.log("_id: "+t.user._id),u()}),[]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"grid md:grid-cols-4 lg:grid-cols-6 grid-cols-2 gap-8 p-12",children:[o.files.map((function(e){return(0,n.jsx)(w,{state:t,file:e,onFileDelete:d},e._id)})),(0,n.jsx)(O,{state:t,onFileDelete:d})]}),(0,n.jsx)(j.Ix,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C=i.createContext(),_={isAuthenticated:!1,user:null,token:null},E=function(e,t){switch(t.type){case"LOGIN":return localStorage.setItem("user",JSON.stringify(t.payload.data.user)),localStorage.setItem("token",JSON.stringify(t.payload.data.token)),D(D({},e),{},{isAuthenticated:!0,user:t.payload.data.user,token:t.payload.data.token});case"LOGOUT":return localStorage.clear(),D(D({},e),{},{isAuthenticated:!1,user:null});default:return e}};var F=function(){var e=i.useReducer(E,_),t=(0,s.Z)(e,2),r=t[0],a=t[1];return(0,n.jsx)(C.Provider,{value:{state:r,dispatch:a},children:(0,n.jsxs)("div",{id:"app",children:[(0,n.jsx)(o,{isAuthenticated:r.isAuthenticated}),(0,n.jsx)("div",{children:r.isAuthenticated?(0,n.jsx)(S,{state:r}):(0,n.jsx)(m,{})})]})})}},8581:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(5283)}])}},function(e){e.O(0,[774,529,888,179],(function(){return t=8581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);